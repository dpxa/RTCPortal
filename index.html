<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RTCPortal - P2P File Sharing</title>
    <meta
      name="description"
      content="Secure peer-to-peer file sharing using WebRTC. No cloud storage needed - files transfer directly between users."
    />

    <link rel="canonical" href="https://dpxa.github.io/RTCPortal/" />
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="images/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="images/favicon-16x16.png"
    />
    <link rel="manifest" href="images/site.webmanifest" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  </head>
  <body>
    <div class="wrapper">
      <div class="header-controls">
        <button id="theme-toggle" class="theme-toggle" title="Toggle Dark Mode">
          â—‹
        </button>
        <a href="https://github.com/dpxa" target="_blank" class="repo-link"
          >GitHub</a
        >
      </div>
      <h1>RTCPortal</h1>
      <main>
        <div class="container">
          <div class="column">
            <section id="connection-panel">
              <h2>Connection</h2>
              <div class="label-container">
                <label for="my-id-display">Your ID:</label>
                <span
                  id="my-id-display"
                  class="inactive"
                  role="status"
                  aria-live="polite"
                >
                  Waiting for ID
                </span>
                <div style="display: flex; gap: 5px">
                  <button
                    id="copy-id-btn"
                    class="copy-button"
                    style="display: none"
                  >
                    Copy ID
                  </button>
                  <button
                    id="copy-link-btn"
                    class="copy-button"
                    style="display: none"
                  >
                    Copy Link
                  </button>
                  <button
                    id="show-qr-btn"
                    class="copy-button"
                    style="display: none"
                    title="Show QR Code"
                  >
                    QR Code
                  </button>
                </div>
                <span id="status-id-message" class="message"></span>
              </div>
              <div
                id="qr-code-wrapper"
                style="
                  display: none;
                  text-align: center;
                  margin-bottom: 4px;
                  margin-top: 0;
                "
              >
                <div
                  id="qr-code-container"
                  style="
                    display: inline-block;
                    padding: 5px;
                    background: white;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                  "
                ></div>
              </div>
              <input
                type="text"
                id="partner-id-field"
                placeholder="Enter peer ID..."
              />
              <button id="connect-btn" disabled>Connect</button>
              <button id="end-btn" class="end-btn" style="display: none">
                Disconnect
              </button>
              <div id="active-connection-container" style="display: none">
                <label id="active-connection-label">Connected to:</label>
                <span id="active-connection-status"></span>
              </div>
            </section>

            <section id="file-transfer-section" style="display: none">
              <h2>Send File</h2>
              <div class="label-container">
                <span
                  id="file-status-message"
                  class="message"
                  role="alert"
                  aria-live="assertive"
                ></span>
              </div>
              <div id="drop-zone" class="drop-zone">
                <p class="drop-zone-text">Drag & Drop files and folders here</p>
                <div class="upload-actions">
                  <button id="browse-files-btn">Select Files</button>
                  <button id="browse-folder-btn">Select Folder</button>
                </div>
                <input
                  type="file"
                  id="upload-field"
                  style="display: none"
                  multiple
                />
                <input
                  type="file"
                  id="folder-upload-field"
                  style="display: none"
                  webkitdirectory
                  directory
                  multiple
                />
                <div id="file-name-display"></div>
              </div>
              <button id="file-transfer-btn" disabled>Send</button>
              <button id="toggle-chat-btn" style="display: none">
                Open Chat
              </button>
            </section>

            <!-- Dynamically create progress bar -->

            <section id="chat-section" style="display: none">
              <h2>Chat</h2>
              <div id="chat-box" class="chat-box">
                <div class="chat-placeholder">No messages yet...</div>
              </div>
              <div class="chat-input-container">
                <input
                  type="text"
                  id="chat-input"
                  placeholder="Type a message..."
                  autocomplete="off"
                />
                <button id="send-chat-btn">Send</button>
              </div>
            </section>
          </div>

          <div class="column" id="transfer-history" style="display: none">
            <section>
              <div class="file-history-header">
                <div class="erase-history-container"></div>
                <div class="file-history-title">
                  <h2>History</h2>
                </div>
                <div class="spacer"></div>
              </div>

              <section id="incoming-section" style="display: none">
                <h3>Received Files</h3>
                <div id="incoming-files"></div>
              </section>

              <section id="outgoing-section" style="display: none">
                <h3>Sent Files</h3>
                <div id="outgoing-files"></div>
              </section>

              <section id="chat-history-section" style="display: none">
                <h3>Chat History</h3>
                <div
                  id="chat-history-list"
                  class="chat-box"
                  style="height: auto; max-height: 300px; overflow-y: auto"
                ></div>
              </section>
            </section>
          </div>
        </div>

        <div class="container">
          <div class="column" id="about-section">
            <h2>About RTCPortal</h2>
            <div id="about-text">
              <p>
                RTCPortal is a secure file-sharing tool that uses
                <a
                  href="https://en.wikipedia.org/wiki/WebRTC"
                  target="_blank"
                  class="webrtc-link"
                  rel="noopener noreferrer"
                  >WebRTC</a
                >
                for direct peer-to-peer transfers. Files are never stored on any
                central server.
              </p>
              <p>
                A Socket.io signaling service helps establish initial
                connections. Once connected, all data transfers happen directly
                between peers for maximum privacy and security.
              </p>
            </div>
          </div>
        </div>

        <div class="container">
          <div class="column" id="stats-section">
            <h2>Connection Statistics</h2>
            <div id="stats-content">
              <div class="stats-row">
                <span class="stats-label">Success Rate:</span>
                <span id="success-rate-display" class="stats-value">-</span>
              </div>
              <div class="stats-row">
                <span class="stats-label">Server Uptime:</span>
                <span id="uptime-display" class="stats-value">-</span>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script src="js/config/constants.js"></script>
    <script src="js/ui/uiManager.js"></script>
    <script src="js/services/turnService.js"></script>
    <script src="js/services/statsService.js"></script>
    <script src="js/core/fileTransferManager.js"></script>
    <!-- webrtcManager is loaded by loadSocketIO.js -->

    <script src="js/loadSocketIO.js"></script>

    <footer>
      <p>&copy; 2026 RTCPortal</p>
    </footer>
  </body>
</html>
